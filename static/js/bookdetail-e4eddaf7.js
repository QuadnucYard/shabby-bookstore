import{g as Y,A as Z,w as tt,B as st,m as et,C as ot,D as nt,F as at,e as lt,a as it,d as ct,z as rt,E as k}from"./element-plus-d03682ba.js";import{_ as dt}from"./SearchBox.vue_vue_type_style_index_0_lang-a5948eb2.js";import{b as _t,u as mt}from"./vue-router-cfababd1.js";import{u as ut}from"./vuex-af3025ab.js";import{U as pt,G as vt,R as ht}from"./@element-plus-b2faaa35.js";import{b as ft,c as gt,p as bt}from"./book-bf9a29d9.js";import{a as yt}from"./order-b56e68b7.js";import{a as kt}from"./favorites-b27948cc.js";import{J as Vt,e as p,a0 as xt,j as Ct,i as wt,ag as V,o as l,c,X as e,S as D,u as s,Q as R,R as i,a as t,W as a,V as _,G as Et,U as f,F as N,a6 as S}from"./@vue-7143f52f.js";import"./lodash-es-6689e95d.js";import"./@vueuse-71394f68.js";import"./@popperjs-c75af06c.js";import"./@ctrl-43a4208a.js";import"./dayjs-904a9561.js";import"./@kangc-6605a7f7.js";import"./vue-58b885c9.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-1d60d822.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-b3b4f581.js";import"./lodash-86c374ca.js";import"./index-f9d2d8f9.js";import"./axios-6667cfca.js";import"./form-data-d2a9677b.js";const Bt={class:"book-intro"},Ft={class:"preview-wrap"},Ut={class:"item-info-wrap"},Dt={class:"title"},Rt={class:"info"},Nt={class:"t1"},St={class:"t1"},It={class:"t1"},Tt={class:"t1"},$t={class:"price-info-wrap"},At=t("div",{class:"dt"},"东 南 价",-1),Lt={class:"dd"},Pt={class:"price"},jt=t("span",null," ￥",-1),zt={class:"price-m"},Gt=t("div",null,[t("div",{class:"dt"},"促　　销"),t("div",{class:"dd"},[t("div",{class:"prom-item"},[t("span",{class:"hl_red_bg"},"满减"),t("span",{class:"hl_red"},"每满99元，可减100元现金，最多可减9元")])])],-1),Ht={class:"buy-box"},Mt={key:0,class:"detail"},Jt=t("div",{class:"mt"},[t("h3",null,"商品详情")],-1),Ot={class:"comment"},Qt=t("div",{class:"mt"},[t("h3",null,"商品评价")],-1),Wt={class:"comments-list"},Xt={class:"comment-item"},qt={class:"user-column"},Kt={class:"user-info"},Yt={class:"comment-column"},Zt={class:"comment-message"},ts={class:"time"},ss={class:"comment-op"},es={key:0,class:"prompt"},os={key:0,class:"post"},ns=t("h3",{style:{"margin-bottom":"1em"}},"发布评论",-1),Rs=Vt({__name:"bookdetail",setup(as){const I=_t(),T=mt(),$=ut(),o=p(null),v=p(1),h=p([]),A=$.state.user,r=xt({text:"",star:5}),x=p(!0),C=p(!0),L=console.log,w=()=>{L("report")},u=Ct(()=>Number.parseInt(I.params.bid));wt(async()=>{o.value=await ft(u.value),x.value=!1,h.value=await gt(u.value),C.value=!1});const P=async()=>{const m=await yt(u.value,v.value);k.success(m.message),T.push({name:"shopping_cart"})},j=async()=>{const m=await kt(u.value);k.success(m.message)},z=async()=>{const m=await bt(u.value,r.star,r.text);k.success(m.message),h.value.push(m.data),r.star=5,r.text=""};return(m,d)=>{const G=dt,H=Y,E=Z,B=V("v-md-preview"),g=tt,M=st,b=et,J=ot,O=nt,Q=at,W=lt,X=V("Star"),q=it,F=ct,K=V("v-md-editor"),U=rt;return l(),c("div",null,[e(G),D((l(),c("div",Bt,[s(o)?(l(),R(J,{key:0,gutter:20},{default:i(()=>[e(E,{span:8},{default:i(()=>[t("div",Ft,[e(H,{src:s(o).cover,alt:s(o).name,fit:"contain"},null,8,["src","alt"])])]),_:1}),e(E,{span:16},{default:i(()=>[t("div",Ut,[t("div",Dt,a(s(o).name),1),e(B,{class:"desc",text:s(o).desc},null,8,["text"]),t("div",Rt,[t("div",null,[t("span",Nt,"作者："+a(s(o).author),1),t("span",St,"出版社："+a(s(o).publisher),1),t("span",It,"出版日期："+a(s(o).publishDate),1)]),t("div",null,[e(g,{class:"t1",modelValue:s(o).rating,"onUpdate:modelValue":d[0]||(d[0]=n=>s(o).rating=n),disabled:""},null,8,["modelValue"]),t("span",Tt,a(s(o).numComments)+"条评论",1)])]),t("div",$t,[t("div",null,[At,t("div",Lt,[t("span",Pt,[jt,t("span",null,a(s(o).price.toFixed(2)),1),t("span",null," ("+a((s(o).price/s(o).originalPrice).toFixed(2))+"折)",1)]),t("span",zt,[_(" 定价 "),t("span",null,"￥"+a(s(o).originalPrice.toFixed(2)),1)])])]),Gt]),t("div",Ht,[e(M,{modelValue:s(v),"onUpdate:modelValue":d[1]||(d[1]=n=>Et(v)?v.value=n:null),min:1,"controls-position":"right"},null,8,["modelValue"]),e(b,{type:"primary",icon:s(pt),color:"#E53935",onClick:P},{default:i(()=>[_(" 加入购物车 ")]),_:1},8,["icon"]),e(b,{type:"primary",icon:s(vt),color:"#D81B60",onClick:j},{default:i(()=>[_(" 加入收藏 ")]),_:1},8,["icon"])])])]),_:1})]),_:1})):f("",!0)])),[[U,s(x)]]),s(o)?(l(),c("div",Mt,[Jt,e(Q,null,{default:i(()=>[(l(!0),c(N,null,S(Object.entries(s(o).keys),([n,y])=>(l(),R(O,{label:n},{default:i(()=>[_(a(y),1)]),_:2},1032,["label"]))),256))]),_:1})])):f("",!0),t("div",Ot,[Qt,D((l(),c("div",Wt,[(l(!0),c(N,null,S(s(h),n=>(l(),c("div",Xt,[t("div",qt,[t("div",Kt,[e(W,{size:30,icon:s(ht),style:{"vertical-align":"center"}},null,8,["icon"]),_(" "+a(n.uname),1)])]),t("div",Yt,[e(g,{modelValue:n.rating,"onUpdate:modelValue":y=>n.rating=y,disabled:""},null,8,["modelValue","onUpdate:modelValue"]),e(B,{text:n.content},null,8,["text"]),t("div",Zt,[t("div",ts,a(n.post_time),1),t("div",ss,[e(F,{underline:!1,class:"op-nice",onClick:w},{default:i(()=>[e(q,null,{default:i(()=>[e(X)]),_:1}),_(" "+a(n.likes),1)]),_:2},1024),e(F,{underline:!1,class:"op-report",onClick:w},{default:i(()=>[_("举报")]),_:1})])])])]))),256)),s(h).length==0?(l(),c("div",es," 评论区空空如也，等待着您购买后的反馈呢！ ")):f("",!0)])),[[U,s(C)]]),s(A)?(l(),c("div",os,[ns,e(g,{modelValue:s(r).star,"onUpdate:modelValue":d[2]||(d[2]=n=>s(r).star=n)},null,8,["modelValue"]),e(K,{modelValue:s(r).text,"onUpdate:modelValue":d[3]||(d[3]=n=>s(r).text=n),height:"200px"},null,8,["modelValue"]),e(b,{type:"primary",color:"#43A047",onClick:z},{default:i(()=>[_("发布！")]),_:1})])):f("",!0)])])}}});export{Rs as default};
