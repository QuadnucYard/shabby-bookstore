import{ag as y,o as A,c as P,X as O,as as L}from"./@vue-7143f52f.js";import{c as b,a as w,u as R}from"./vue-router-cfababd1.js";import{c as I,u as V}from"./vuex-af3025ab.js";import{E as p,i as S}from"./element-plus-d03682ba.js";import{Q as T}from"./@element-plus-b2faaa35.js";import{V as d,a as h,b as g}from"./@kangc-6605a7f7.js";import{a as D}from"./axios-6667cfca.js";import"./lodash-es-6689e95d.js";import"./@vueuse-71394f68.js";import"./@popperjs-c75af06c.js";import"./@ctrl-43a4208a.js";import"./dayjs-904a9561.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-1d60d822.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-b3b4f581.js";import"./vue-58b885c9.js";import"./form-data-d2a9677b.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();const q=(e,t)=>{const o=e.__vccOpts||e;for(const[n,s]of t)o[n]=s;return o},M={},N={id:"app"};function $(e,t){const o=y("router-view");return A(),P("div",N,[O(o)])}const C=q(M,[["render",$]]),j="modulepreload",x=function(e,t){return new URL(e,t).href},_={},i=function(t,o,n){if(!o||o.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(o.map(r=>{if(r=x(r,n),r in _)return;_[r]=!0;const a=r.endsWith(".css"),k=a?'[rel="stylesheet"]':"";if(!!n)for(let u=s.length-1;u>=0;u--){const m=s[u];if(m.href===r&&(!a||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${k}`))return;const l=document.createElement("link");if(l.rel=a?"stylesheet":j,a||(l.as="script",l.crossOrigin=""),l.href=r,document.head.appendChild(l),a)return new Promise((u,m)=>{l.addEventListener("load",u),l.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())},B=[{path:"/",component:()=>i(()=>import("./index-12caaa38.js"),["./index-12caaa38.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vue-7143f52f.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./vue-router-cfababd1.js","./vuex-af3025ab.js","./auth-ec85d572.js","./axios-6667cfca.js","./form-data-d2a9677b.js","..\\css\\index-543b7da2.css"],import.meta.url),meta:{keepalive:!1},children:[{path:"/",name:"home",component:()=>i(()=>import("./home-b09ef933.js"),["./home-b09ef933.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vue-7143f52f.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./SearchBox.vue_vue_type_style_index_0_lang-a5948eb2.js","./vue-router-cfababd1.js","./lodash-86c374ca.js","..\\css\\SearchBox-6f7e87e0.css","..\\css\\home-cdec3643.css"],import.meta.url),meta:{keepalive:!1}},{path:"/auth/login",name:"login",component:()=>i(()=>import("./login-74e11279.js"),["./login-74e11279.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vue-7143f52f.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./vue-router-cfababd1.js","./vuex-af3025ab.js","./auth-ec85d572.js","./rsaEncrypt-33a8859d.js","./jsencrypt-a25df808.js","./js-cookie-cf83ad76.js","./axios-6667cfca.js","./form-data-d2a9677b.js","..\\css\\login-8ea7b434.css"],import.meta.url),meta:{keepalive:!1}},{path:"/auth/register",name:"register",component:()=>i(()=>import("./register-87beb1bc.js"),["./register-87beb1bc.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vue-7143f52f.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./vue-router-cfababd1.js","./vuex-af3025ab.js","./auth-ec85d572.js","./rsaEncrypt-33a8859d.js","./jsencrypt-a25df808.js","./axios-6667cfca.js","./form-data-d2a9677b.js","..\\css\\register-001df9ce.css"],import.meta.url),meta:{keepalive:!1}},{path:"/book/list",name:"booklist",component:()=>i(()=>import("./booklist-a2c4b8a3.js"),["./booklist-a2c4b8a3.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vue-7143f52f.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./vue-router-cfababd1.js","./lodash-86c374ca.js","./SearchBox.vue_vue_type_style_index_0_lang-a5948eb2.js","..\\css\\SearchBox-6f7e87e0.css","./book-bf9a29d9.js","./order-b56e68b7.js","./favorites-b27948cc.js","./vuex-af3025ab.js","./axios-6667cfca.js","./form-data-d2a9677b.js","..\\css\\booklist-e8d76dfc.css"],import.meta.url),meta:{keepalive:!1}},{path:"/book/:bid(\\d+)",name:"bookdetail",component:()=>i(()=>import("./bookdetail-e4eddaf7.js"),["./bookdetail-e4eddaf7.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vue-7143f52f.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./SearchBox.vue_vue_type_style_index_0_lang-a5948eb2.js","./vue-router-cfababd1.js","./lodash-86c374ca.js","..\\css\\SearchBox-6f7e87e0.css","./vuex-af3025ab.js","./book-bf9a29d9.js","./order-b56e68b7.js","./favorites-b27948cc.js","./axios-6667cfca.js","./form-data-d2a9677b.js","..\\css\\bookdetail-c52d5069.css"],import.meta.url),meta:{keepalive:!1}},{path:"/favorites",name:"favorites",component:()=>i(()=>import("./favorites-e57db718.js"),["./favorites-e57db718.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vue-7143f52f.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./favorites-b27948cc.js","./array-extensions-336e79e9.js","./vue-router-cfababd1.js","./vuex-af3025ab.js","./axios-6667cfca.js","./form-data-d2a9677b.js","..\\css\\favorites-b964599a.css"],import.meta.url),meta:{keepalive:!1,requireAuth:!0}},{path:"/shopping_cart",name:"shopping_cart",component:()=>i(()=>import("./shopping_cart-f1c86f25.js"),["./shopping_cart-f1c86f25.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vue-7143f52f.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./vue-router-cfababd1.js","./order-b56e68b7.js","./lodash-86c374ca.js","./array-extensions-336e79e9.js","./vuex-af3025ab.js","./axios-6667cfca.js","./form-data-d2a9677b.js","..\\css\\shopping_cart-6c942f74.css"],import.meta.url),meta:{keepalive:!1,requireAuth:!0}},{path:"/shopping/checkout",name:"checkout",component:()=>i(()=>import("./checkout-d783e58f.js"),["./checkout-d783e58f.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vue-7143f52f.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./vue-router-cfababd1.js","./vuex-af3025ab.js","./order-b56e68b7.js","./axios-6667cfca.js","./form-data-d2a9677b.js","..\\css\\checkout-a998454c.css"],import.meta.url),meta:{keepalive:!1,requireAuth:!0}},{path:"/:pathMatch(.*)",name:"error",component:()=>i(()=>import("./Error404-b2105452.js"),["./Error404-b2105452.js","./@vue-7143f52f.js","./vue-router-cfababd1.js","./vuex-af3025ab.js","./element-plus-d03682ba.js","./lodash-es-6689e95d.js","./@vueuse-71394f68.js","./@element-plus-b2faaa35.js","./@popperjs-c75af06c.js","./@ctrl-43a4208a.js","./dayjs-904a9561.js","./@kangc-6605a7f7.js","./vue-58b885c9.js","..\\css\\@kangc-b28cd10e.css","./async-validator-dee29e8b.js","./memoize-one-297ddbcb.js","./escape-html-1d60d822.js","./normalize-wheel-es-ed76fb12.js","./@floating-ui-b3b4f581.js","..\\css\\element-plus-be17b3d6.css","./axios-6667cfca.js","./form-data-d2a9677b.js","..\\css\\Error404-b726628c.css"],import.meta.url)}]}],v=b({history:w("/shabby-bookstore/"),routes:B}),E=I({state:{user:window.localStorage.getItem("user")?JSON.parse(window.localStorage.getItem("user")):null,adminMenus:[]},mutations:{initAdminMenu(e,t){e.adminMenus=t},login(e,t){e.user=t,window.localStorage.setItem("user",JSON.stringify(t))},logout(e){e.user=null,window.localStorage.removeItem("user"),e.adminMenus=[]}},actions:{}});const f=D.create({baseURL:"http://127.0.0.1:5000/api",timeout:5e3,withCredentials:!0,headers:{"Access-Control-Allow-Origin":"*"}});f.interceptors.request.use(e=>e,e=>{console.log(e),Promise.reject(e)});f.interceptors.response.use(e=>{const t=e.status;return t<200||t>300?Promise.reject("error"):e},e=>{let t=0;try{t=e.response.status}catch{if(e.toString().indexOf("Error: timeout")!==-1)return p.error("网络请求超时"),Promise.reject(e)}if(t)if(t===401)V().dispatch("logout").then(()=>{location.reload()});else if(t===403)R().push({path:"/401"});else{const o=e.response.data.message;o!==void 0?p.error(o):p.error("Unknown error")}else p.error("接口请求失败");return Promise.reject(e)});d.use(h);g.use(h);const c=L(C);c.use(v).use(S).use(E);c.use(d).use(g);console.log(c);for(const[e,t]of Object.entries(T))c.component(e,t);c.mount("#app");v.beforeEach((e,t,o)=>{console.log("beforeEach",e.meta.requireAuth),e.meta.requireAuth?E.state.user?f.get("/auth").then(n=>{n&&o()}):o({name:"login",query:{redirect:e.fullPath}}):o()});export{q as _,f as s};
